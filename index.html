<html>

<head>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
        <title>Portal do Cliente</title>
        <link rel="stylesheet" href="estilo/font-awesome.min.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
        <link href="estilo/style.css" rel="stylesheet"/>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <meta name="keywordes" content="palavras-chaves,do,meu,site">
     <meta name="description" content="Diversos produtos para você!."> 
         <meta charset="utf-8"/>
    
    
      


    <title>Portal do Cliente</title>
    <style>
        * {
            font-family: Verdana, Geneva, Tahoma, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #35352b;
        }

        .cliente {
            text-align: center;
        }

        .cliente img {
            max-width: 500px;
            width: 30%;
        }

        .cliente h2 {
            color: black;
            padding: 10px;
        }

        .cliente textarea {

            width: 30%;
            height: 40px;
            padding: 10px;
        }

        .cliente input {
            padding: 10px;
            width: 30%;
            height: 40px;
            cursor: pointer;
        }

        .admin {
            text-align: center;
        }

        .admin h2 {
            color: black;
            padding: 10px;
        }


        @media screen and (max-width: 700px){



            #form-cliente2{

                text-align: center;
                padding: 20px;
            }

            .cliente input {
            padding: 10px;
            width: 30%;
            height: 40px;
            cursor: pointer;
        }

        .cliente textarea {

width: 55%;
height: 40px;
padding: 10px;
}

.cliente h2 {
            color: black;
            padding: 10px;
        }


}

    </style>
</head>

<body>
    <div style="display: none" class="cliente">
   


         <h2>Cadastrar Variedades</h2>
    <form id="form-cliente3">
        <textarea placeholder="Digite a vaga que procura..." name="comprovante6"></textarea><br>
        <input type="file" name="arquivo3" /><br>
        <input type="submit" name="acao6" value="Enviar" />
        
    </form>
    <br>    

        <h2>Cadastrar Carregador</h2>

        <form id="form-cliente2">
            <textarea placeholder="Digite a vaga que procura..." name="comprovante2"></textarea><br>
            <input type="file" name="arquivo2" /><br>
            <input type="submit" name="acao2" value="Enviar" />
            
        </form>
    <br>

    <h2>Cadastrar Caixa de Som</h2>
    <form id="form-cliente">
        <textarea placeholder="Digite a vaga que procura..." name="comprovante1"></textarea><br>
        <input type="file" name="arquivo1" /><br>
        <input type="submit" name="acao1" value="Enviar" />
        
    </form>
    <br>


<h2>Cadastrar Fone via Bluetooth</h2>
    <form id="form-cliente4">
        <textarea placeholder="Digite a vaga que procura..." name="comprovante7"></textarea><br>
        <input type="file" name="arquivo4" /><br>
        <input type="submit" name="acao7" value="Enviar" />
        
    </form>
    <br>

    <h2>Cadastrar Titulo 1</h2>

        <form id="form-Titulo1">
            <textarea placeholder="Digite a vaga que procura..." name="comprovante3"></textarea><br>
            <br>
            <input type="submit" name="acao3" value="Enviar" />
            
        </form>
    <br>

    <h2>Cadastrar Titulo 2</h2>

        <form id="form-Titulo2">
            <textarea placeholder="Digite a vaga que procura..." name="comprovante4"></textarea><br>
            <br>
            <input type="submit" name="acao4" value="Enviar" />
            
        </form>
    <br>



<h2>Cadastrar Titulo 3</h2>

        <form id="form-Titulo3">
            <textarea placeholder="Digite a vaga que procura..." name="comprovante5"></textarea><br>
            <br>
            <input type="submit" name="acao5" value="Enviar" />
            
        </form>
    <br>


<h2>Cadastrar Titulo 4</h2>

        <form id="form-Titulo4">
            <textarea placeholder="Digite a vaga que procura..." name="comprovante8"></textarea><br>
            <br>
            <input type="submit" name="acao8" value="Enviar" />
            
        </form>
    <br>



</div>
    <!--CLIENTE-->

    <div style="display: none" class="admin">
        <img src="imgs/02.png"><br>
        <a id="login" href="#"><img src="imgs/img01.png" /></a>
        <div style="display:none" class="listar-formularios">
            <h2>Ultimas solicitações:</h2>
            <div class="container-pedidos">

            </div>
            <!--CONTAINER-PEDIDOS-->>
        </div>
    </div>
    <!--ADMIN-->

    <script src="https://www.gstatic.com/firebasejs/8.6.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.5.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.5.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.5.0/firebase-storage.js"></script>

    <script>
        var  firebaseConfig = {
        apiKey: "AIzaSyAlyKAt0Eg57cb8GZDalCaEwIALPWPAEds",
        authDomain: "painel-loguin.firebaseapp.com",
        projectId: "painel-loguin",
        storageBucket: "painel-loguin.appspot.com",
        messagingSenderId: "24549930727",
        appId: "1:24549930727:web:98a17c160e55172c4bd442"
      };
        firebase.initializeApp(firebaseConfig);

        const storage = firebase.storage();
        const db = firebase.firestore();
        const auth = firebase.auth();

        const provider = new firebase.auth.GoogleAuthProvider();

        const formCliente = document.querySelector('#form-cliente');
        formCliente.addEventListener('submit', (e) => {
            e.preventDefault();
            let comprovanteText = document.querySelector('[name=comprovante1]').value;
            let arquivo = document.querySelector('[name=arquivo1]').files[0];

            const uploadTask = storage.ref('caixa/' + arquivo.name).put(arquivo);

            uploadTask.on('state_changed', (snapshot) => {
                const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 1;
                console.log(progress);
            },
                function (error) {

                },
                function () {
                    storage.ref('caixa/' + arquivo.name).getDownloadURL().then((url) => {
                        db.collection('caixa').add({
                            descricao: comprovanteText,
                            arquivoURL: url
                        })
                        alert("Cadastro Enviado com sucesso!");
                    })
                }
            )
        })


/***************************************************************************/

        const formCliente2 = document.querySelector('#form-cliente2');
        formCliente2.addEventListener('submit', (e) => {
            e.preventDefault();
            let comprovanteText = document.querySelector('[name=comprovante2]').value;
            let arquivo = document.querySelector('[name=arquivo2]').files[0];

            const uploadTask0 = storage.ref('carregador/' + arquivo.name).put(arquivo);

            uploadTask0.on('state_changed', (snapshot) => {
                const progress0 = (snapshot.bytesTransferred / snapshot.totalBytes) * 1;
                console.log(progress0);
            },
                function (error) {

                },
                function () {
                    storage.ref('carregador/' + arquivo.name).getDownloadURL().then((url) => {
                        db.collection('carregador').add({
                            descricao: comprovanteText,
                            arquivoURL: url
                        })
                        alert("Cadastro Enviado com sucesso!");
                    })
                }
            )
        })

/****************************************************************************/




/***************************************************************************/

        const formCliente3 = document.querySelector('#form-cliente3');
        formCliente3.addEventListener('submit', (e) => {
            e.preventDefault();
            let comprovanteText = document.querySelector('[name=comprovante6]').value;
            let arquivo = document.querySelector('[name=arquivo3]').files[0];

            const uploadTask1 = storage.ref('variedades/' + arquivo.name).put(arquivo);

            uploadTask1.on('state_changed', (snapshot) => {
                const progress1 = (snapshot.bytesTransferred / snapshot.totalBytes) * 1;
                console.log(progress0);
            },
                function (error) {

                },
                function () {
                    storage.ref('variedades/' + arquivo.name).getDownloadURL().then((url) => {
                        db.collection('variedades').add({
                            descricao: comprovanteText,
                            arquivoURL: url
                        })
                        alert("Cadastro Enviado com sucesso!");
                    })
                }
            )
        })

/****************************************************************************/




/***************************************************************************/

        const formCliente4 = document.querySelector('#form-cliente4');
        formCliente4.addEventListener('submit', (e) => {
            e.preventDefault();
            let comprovanteText = document.querySelector('[name=comprovante7]').value;
            let arquivo = document.querySelector('[name=arquivo4]').files[0];

            const uploadTask2 = storage.ref('fone/' + arquivo.name).put(arquivo);

            uploadTask2.on('state_changed', (snapshot) => {
                const progress2 = (snapshot.bytesTransferred / snapshot.totalBytes) * 1;
                console.log(progress2);
            },
                function (error) {

                },
                function () {
                    storage.ref('fone/' + arquivo.name).getDownloadURL().then((url) => {
                        db.collection('fone').add({
                            descricao: comprovanteText,
                            arquivoURL: url
                        })
                        alert("Cadastro Enviado com sucesso!");
                    })
                }
            )
        })

/****************************************************************************/


/***************************************************************************/

        const formTitulo1 = document.querySelector('#form-Titulo1');
        formTitulo1.addEventListener('submit', (e) => {
            e.preventDefault();
            let comprovanteText = document.querySelector('[name=comprovante3]').value;
           

            const uploadTask3 = storage.ref('titulo1/' + name).put(name);

            uploadTask3.on('state_changed', (snapshot) => {
                const progress3 = (snapshot.bytesTransferred / snapshot.totalBytes) * 1;
                console.log(progress3);
            },
                function (error) {

                },
                function () {
                    storage.ref('titulo1/' + name).getDownloadURL().then((url) => {
                        db.collection('titulo1').add({
                            descricao: comprovanteText,
                           
                        })
                        alert("Titulo1 Cadastrado!");
                    })
                }
            )
        })

/****************************************************************************/

/***************************************************************************/

        const formTitulo2 = document.querySelector('#form-Titulo2');
        formTitulo2.addEventListener('submit', (e) => {
            e.preventDefault();
            let comprovanteText = document.querySelector('[name=comprovante4]').value;
           

            const uploadTask3 = storage.ref('titulo2/' + name).put(name);

            uploadTask3.on('state_changed', (snapshot) => {
                const progress3 = (snapshot.bytesTransferred / snapshot.totalBytes) * 1;
                console.log(progress3);
            },
                function (error) {

                },
                function () {
                    storage.ref('titulo2/' + name).getDownloadURL().then((url) => {
                        db.collection('titulo2').add({
                            descricao: comprovanteText,
                           
                        })
                        alert("Titulo2 Cadastrado!");
                    })
                }
            )
        })

/****************************************************************************/



   /***************************************************************************/

        const formTitulo3 = document.querySelector('#form-Titulo3');
        formTitulo3.addEventListener('submit', (e) => {
            e.preventDefault();
            let comprovanteText = document.querySelector('[name=comprovante5]').value;
           

            const uploadTask3 = storage.ref('titulo3/' + name).put(name);

            uploadTask3.on('state_changed', (snapshot) => {
                const progress3 = (snapshot.bytesTransferred / snapshot.totalBytes) * 1;
                console.log(progress3);
            },
                function (error) {

                },
                function () {
                    storage.ref('titulo3/' + name).getDownloadURL().then((url) => {
                        db.collection('titulo3').add({
                            descricao: comprovanteText,
                           
                        })
                        alert("Titulo3 Cadastrado!");
                    })
                }
            )
        })

/****************************************************************************/




        const formTitulo4 = document.querySelector('#form-Titulo4');
        formTitulo4.addEventListener('submit', (e) => {
            e.preventDefault();
            let comprovanteText = document.querySelector('[name=comprovante8]').value;
           

            const uploadTask3 = storage.ref('titulo4/' + name).put(name);

            uploadTask3.on('state_changed', (snapshot) => {
                const progress3 = (snapshot.bytesTransferred / snapshot.totalBytes) * 1;
                console.log(progress3);
            },
                function (error) {

                },
                function () {
                    storage.ref('titulo4/' + name).getDownloadURL().then((url) => {
                        db.collection('titulo4').add({
                            descricao: comprovanteText,
                           
                        })
                        alert("Titulo4 Cadastrado!");
                    })
                }
            )
        })

/****************************************************************************/



        const loginBtn = document.getElementById('login');
        loginBtn.addEventListener('click', (e) => {
            e.preventDefault();
            auth.signInWithPopup(provider);
        })

        //PUXAR PEDIDOS DO FIRESTORE
        db.collection('documentos').onSnapshot((data) => {
            let list = document.querySelector('.container-pedidos');
            list.innerHTML = "";
            data.docs.map((val) => {
                list.innerHTML += `
                    <div style="display:flex; background-color:white; padding:20px;margin-bottom:20px;text-align:left;" class="container-single-pedido">
                        <p>${val.data().descricao}</p>
                        <img style="max-width:150px; margin-top:10px;" src ="${val.data().arquivoURL}"
                    </div>
                    <hr>
                `;
            })
        })

    </script>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const myParam = urlParams.get('admin');

        if (myParam != null) {
            //Eu quero entrar na parte administrativa.
            const adminArea = document.querySelector('.admin');
            adminArea.style.display = "block";
            console.log("Área do administrador");

            auth.onAuthStateChanged((val) => {
                if (val.email == "edilson.aria@gmail.com") {
                    loginBtn.style.display = "none";
                    document.querySelector('.listar-formularios').style.display = "block";
                    alert('Você está logado, admin!');
                    console.log("Logado como admin.");
                } else {
                    alert('Este email não é autorizado!');
                    console.log("Usuário não logado como admin.");
                }
            })

        } else {
            //Eu sou usuário.
            const clientArea = document.querySelector('.cliente');
            clientArea.style.display = "block";
            console.log("Área do usuário");
        }
    </script>
</body>

</html>
